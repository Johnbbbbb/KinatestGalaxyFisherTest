<tool id="kinatestid_r" name="Kinatest-ID 7_to_7" version="0.1.0">
    <description>calculate optimal substrates given a Fisher odds table</description>
    <requirements>
       <requirement type="package">R</requirement>
    </requirements>
    <command><![CDATA[
        ln -s '$fisher_table' output1.csv && 
        ln -s '$characterization_table' output2 && 
        Rscript '$__tool_directory__/KinatestFisherScoring-working.R' outGroup pn7 pn6 pn5 pn4 pn3 pn2 pn1 pz0 pp1 pp2 pp3 pp4 pp5 pp6 pp7
    ]]></command>
    <inputs>
        <param format="csv" name="fisher_table" type="data" label="Kinase's Fisher Odds table"/>
        <param format="csv" name="characterization_table" type="data" label="Kinase's characterization table"/>
		<param name="outGroup" type="text" value="kinase" label="Kinase Name"/>
		
		<param name="pn6" type="text" value="A" label="Position -6"/>
		<param name="pn5" type="text" value="A" label="Position -5"/>
		<param name="pn4" type="text" value="A" label="Position -4"/>
		<param name="pn3" type="text" value="A" label="Position -3"/>
		
		<param name="pn2" type="text" value="A" label="Position -2"/>
		<param name="pn1" type="text" value="A" label="Position -1"/>
		<param name="pz0" type="text" value="Y" label="Position 0"/>
		<param name="pp1" type="text" value="A" label="Position 1"/>
		<param name="pp2" type="text" value="A" label="Position 2"/>
		
		<param name="pp3" type="text" value="A" label="Position 3"/>
		<param name="pp4" type="text" value="A" label="Position 4"/>
		<param name="pp5" type="text" value="A" label="Position 5"/>
		<param name="pp6" type="text" value="A" label="Position 6"/>
    </inputs>      
    <outputs>
        <data format="csv" name="SDtable" from_work_dir="output1.csv" label="${outGroup}_Candidate Substrate Sequences"/>
    </outputs>

    
    <help><![CDATA[
Important!
**Please write the name of your kinase in ALL CAPS so the R script can recognize it!  Thank you!**
**If your kinase is one of the following kinases, please use this form of its name:  ABL, ARG, BTK, CSK, FYN, HCK, JAK2, LCK, LYN, PYK2, SRC, SYK, YES, FLT3**
**So for example if your kinase is ARG please use ARG and not ABL2**
	
This tool is intended for use in conjunction with the Kinatest Fisher Test tool, available on GalaxyP.  It uses the output from that tool and user input to generate candidate substrate sequences.

When the user has a Fisher Odds table for their kinase of interest (generated by the tool called "Kinatest-ID using Fisher's Exact Test"), they can check which amino acids at which positions are significantly over or under 
represented in the kinase's preferred substrate motif.  They can then mark down which are over-represented and input those into this tool to generate candidate sequences.
Note that EVERY POSITION MUST HAVE AN AMINO ACID, and also note that if TOO many acids are input into this tool, it could take until the heat death of the universe to finish calculating all the candidate 
sequences and how they interact with both the kinase of interest and other kinases.  As an example, if 3 amino acids are marked down for every position (excluding the central tyrosine), that 
will mean 3^12 or about half a million candidate sequences will be generated.  If 4 amino acids are marked down for each position, that will mean 4^12 or about 16 million sequences will be generated.  A good rule of 
thumb is to not have more than 5 million or so sequences, if you need to have a lot of choice of amino acids in a certain position, pair down the other positions.

    ]]></help>
    <citations>
        <citation type="doi">10.1021/ja507164a</citation>
    </citations>
</tool>

